<div class="auth-wrapper">
  <div class="auth-card register-card">
    <div class="brand">
      <h1>WasteZero</h1>
      <p>Create an account to get started</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="auth-form mt-4">
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="fullName">Full Name</label>
          <div class="input-container">
            <input
              type="text"
              id="fullName"
              formControlName="fullName"
              class="form-control"
              [class.is-invalid]="
                registerForm.get('fullName')?.invalid &&
                registerForm.get('fullName')?.touched
              "
            />
          </div>
          <div
            class="error-msg"
            *ngIf="
              registerForm.get('fullName')?.invalid &&
              registerForm.get('fullName')?.touched
            "
          >
            <small>Name is required</small>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="username">Username</label>
          <div class="input-container">
            <input
              type="text"
              id="username"
              formControlName="username"
              class="form-control"
              [class.is-invalid]="
                registerForm.get('username')?.invalid &&
                registerForm.get('username')?.touched
              "
            />
          </div>
          <div
            class="error-msg"
            *ngIf="
              registerForm.get('username')?.invalid &&
              registerForm.get('username')?.touched
            "
          >
            <small>Username is required</small>
          </div>
        </div>
      </div>

      <div class="mb-3">
        <label for="email">Email Address</label>
        <div class="input-container">
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            [class.is-invalid]="
              registerForm.get('email')?.invalid &&
              registerForm.get('email')?.touched
            "
          />
        </div>
        <div
          class="error-msg"
          *ngIf="
            registerForm.get('email')?.invalid &&
            registerForm.get('email')?.touched
          "
        >
          <small *ngIf="registerForm.get('email')?.errors?.['required']"
            >Email is required</small
          >
          <small *ngIf="registerForm.get('email')?.errors?.['email']"
            >Enter a valid email</small
          >
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="password">Password</label>
          <div class="input-container">
            <input
              type="password"
              id="password"
              formControlName="password"
              class="form-control"
              [class.is-invalid]="
                registerForm.get('password')?.invalid &&
                registerForm.get('password')?.touched
              "
            />
          </div>
          <div
            class="error-msg"
            *ngIf="
              registerForm.get('password')?.invalid &&
              registerForm.get('password')?.touched
            "
          >
            <small *ngIf="registerForm.get('password')?.errors?.['required']"
              >Password is required</small
            >
            <small *ngIf="registerForm.get('password')?.errors?.['minlength']"
              >Min 6 characters</small
            >
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="confirmPassword">Confirm Password</label>
          <div class="input-container">
            <input
              type="password"
              id="confirmPassword"
              formControlName="confirmPassword"
              class="form-control"
              [class.is-invalid]="
                registerForm.get('confirmPassword')?.touched &&
                (registerForm.get('confirmPassword')?.invalid ||
                  registerForm.errors?.['mismatch'])
              "
            />
          </div>
          <div
            class="error-msg"
            *ngIf="
              registerForm.get('confirmPassword')?.touched &&
              (registerForm.get('confirmPassword')?.invalid ||
                registerForm.errors?.['mismatch'])
            "
          >
            <small
              *ngIf="registerForm.get('confirmPassword')?.errors?.['required']"
              >Confirm your password</small
            >
            <small
              *ngIf="
                registerForm.errors?.['mismatch'] &&
                !registerForm.get('confirmPassword')?.errors?.['required']
              "
              >Passwords do not match</small
            >
          </div>
        </div>
      </div>

      <div class="mb-3">
        <label for="role">Role</label>
        <div class="input-container">
          <select
            id="role"
            formControlName="role"
            class="form-select"
            [class.is-invalid]="
              registerForm.get('role')?.invalid &&
              registerForm.get('role')?.touched
            "
          >
            <option value="User">User (Citizen)</option>
            <option value="Volunteer">Volunteer (Pickup Agent)</option>
            <option value="Admin">Admin</option>
          </select>
        </div>
        <div
          class="error-msg"
          *ngIf="
            registerForm.get('role')?.invalid &&
            registerForm.get('role')?.touched
          "
        >
          <small>Role is required</small>
        </div>
      </div>

      <div class="mb-4">
        <label for="location">Location</label>
        <div class="input-container">
          <input
            type="text"
            id="location"
            formControlName="location"
            class="form-control"
            [class.is-invalid]="
              registerForm.get('location')?.invalid &&
              registerForm.get('location')?.touched
            "
          />
        </div>
        <div
          class="error-msg"
          *ngIf="
            registerForm.get('location')?.invalid &&
            registerForm.get('location')?.touched
          "
        >
          <small>Location is required</small>
        </div>
      </div>

      <button type="submit" class="btn btn-primary w-100 btn-lg shadow-sm" [disabled]="isSubmitting">
        <span *ngIf="!isSubmitting">Create Account</span>
        <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      </button>

      <div class="auth-footer">
        <p>Already have an account? <a routerLink="/login">Sign In here</a></p>
      </div>
    </form>
  </div>
</div>
